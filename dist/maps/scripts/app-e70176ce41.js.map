{"version":3,"sources":["scripts/app-e70176ce41.js"],"names":["angular","module","erMap","ErMapController","$log","$timeout","$element","GeoDataService","addMarkers","list","markers","map","removeLayer","clearLayers","length","mapWIP","console","time","markerList","i","a","latitude","longitude","marker","L","Marker","LatLng","id","push","MarkerClusterGroup","chunkedLoading","chunkProgress","updateProgressBar","addLayers","on","clickMarker","addLayer","processed","total","elapsed","layersArray","progress","$","progressBar","style","display","width","Math","round","timeEnd","e","info","Map","center","zoom","layers","TileLayer","maxZoom","subscribe","log","directive","restrict","templateUrl","scope","controller","controllerAs","bindToController","$inject","ItemDetailsModalController","$uibModalInstance","item","vm","this","close","erMain","ErMainController","FilterService","totalDisplayItems","loadData","erGrid","ErGridController","GridService","gridOptions","api","setRowData","ErFilterModalController","filter","datepickerOptions","date","dateA","opened","dateB","removeAll","filterData","cancel","dismiss","UtilsService","$filter","formatDate","Service","factory","ItemDetailsService","$uibModal","openModal","open","animation","size","resolve","getItem","dateComparator","date1","date2","date1Number","monthToComparableNumber","date2Number","undefined","yearNumber","substring","monthNumber","dayNumber","result","cellRendererGender","params","value","columnDefs","headerName","field","comparator","cellRenderer","enableSorting","pinnedColumnCount","rowData","$http","$q","Files","loadDataComplete","results","forEach","_list","concat","data","totalItems","_observer","onNext","loadDataFailed","error","toJson","all","method","url","then","_","find","name","enabled","gender","position","_filteredList","indexOf","startLatValue","endLatValue","startLngValue","endLngValue","startValue","registered","endValue","Icon","Default","imagePath","Rx","Observable","create","observer","share","$sce","modalInstance","refreshData","Date","removeAllAndRefresh","filterDisplayText","getDisplay","_currentFilter","txt","trustAsHtml","formatYear","startingDay","routerConfig","$stateProvider","$urlRouterProvider","state","template","otherwise","config","constant","$logProvider","debugEnabled","run","$templateCache","put"],"mappings":"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","file":"scripts/app-e70176ce41.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('app', [\n      'ngAnimate',\n      'ngTouch',\n      'ngSanitize',\n      'ngAria',\n      'ui.router',\n      'ui.bootstrap',\n      'agGrid'\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .directive('erMap', erMap);\n\n  /** @ngInject */\n  function erMap() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/map/erMap.tpl.html',\n      scope: {},\n      controller: ErMapController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function ErMapController($log, $timeout, $element, GeoDataService) {\n      var vm = this;\n      \n      var map = new L.Map('map', {\n        center: new L.LatLng(45.755658, 4.834432), \n        zoom: 13, \n        layers: [new L.TileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', { maxZoom: 21 })]\n      });\n\n      var markers = null;\n\n      GeoDataService.list.subscribe(function(list) {\n        $log.log('Observable subscriber called ---> MAP ', list.length);\n        addMarkers(list);\n      })\n\n      function addMarkers(list) {\n        if(markers) {\n          map.removeLayer(markers);\n          markers.clearLayers();\n          markers = null;\n        }\n\n        if(list.length == 0) return;\n\n        GeoDataService.mapWIP = true;\n        console.time('clustering');\n\n        var markerList = [];\n        for (var i = 0; i < list.length; i++) {\n          var a = list[i];\n          if(a.latitude && a.longitude) {\n            var marker = new L.Marker(new L.LatLng(a.latitude, a.longitude), { id: a.id });\n            markerList.push(marker);\n          }\n        }\n\n        $timeout(function() {\n          markers = new L.MarkerClusterGroup({ chunkedLoading: true, chunkProgress: updateProgressBar });\n          markers.addLayers(markerList);\n          markers.on('click', clickMarker);\n          map.addLayer(markers);\n        });\n      }\n\n      function updateProgressBar(processed, total, elapsed, layersArray) {\n        var progress = $('#progress', $element)[0];\n        var progressBar = $('#progress-bar', $element)[0];\n\n        if (elapsed > 1000) {\n          progress.style.display = 'block';\n          progressBar.style.width = Math.round(processed/total*100) + '%';\n        }\n\n        if (processed === total) {\n          progress.style.display = 'none';\n\n          console.timeEnd('clustering');\n\n          $timeout(function() {\n            GeoDataService.mapWIP = false;\n          })\n        }\n      }\n\n      function clickMarker(e) {\n        $log.info('click > ', e);\n      }\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('ItemDetailsModalController', ItemDetailsModalController);\n\n  /** @ngInject */\n  function ItemDetailsModalController($uibModalInstance, item) {\n    var vm = this;\n\n    vm.item = item;\n\n    vm.close = function() {\n      $uibModalInstance.close();\n    };\n  }\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .directive('erMain', erMain);\r\n\r\n  /** @ngInject */\r\n  function erMain() {\r\n    var directive = {\r\n      restrict: 'E',\r\n      templateUrl: 'app/components/main/erMain.tpl.html',\r\n      scope: {},\r\n      controller: ErMainController,\r\n      controllerAs: 'vm',\r\n      bindToController: true\r\n    };\r\n\r\n    return directive;\r\n\r\n    /** @ngInject */\r\n    function ErMainController($log, GeoDataService, FilterService) {\r\n      var vm = this;\r\n\r\n      vm.GeoDataService = GeoDataService;\r\n      vm.FilterService = FilterService;\r\n      vm.totalDisplayItems = 0;\r\n\r\n      GeoDataService.list.subscribe(function(list) {\r\n        $log.log('Observable subscriber called ---> MAIN ', list.length);\r\n        vm.totalDisplayItems = list.length;\r\n      });\r\n\r\n      GeoDataService.loadData();\r\n    }\r\n  }\r\n\r\n})();\r\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .directive('erGrid', erGrid);\n\n  /** @ngInject */\n  function erGrid() {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/grid/erGrid.tpl.html',\n      scope: {},\n      controller: ErGridController,\n      controllerAs: 'vm',\n      bindToController: true\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function ErGridController($log, $timeout, GeoDataService, GridService) {\n      var vm = this;\n\n      vm.gridOptions = GridService.gridOptions;\n\n      GeoDataService.list.subscribe(function(list) {\n        $log.log('Observable subscriber called ---> GRID ', list.length);\n\n        vm.gridOptions.api.setRowData(list);\n      });\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('ErFilterModalController', ErFilterModalController);\n\n  /** @ngInject */\n  function ErFilterModalController($uibModalInstance, $log, FilterService) {\n    var vm = this;\n\n    vm.filter = FilterService.filter;\n    vm.datepickerOptions = FilterService.datepickerOptions;\n    vm.date = {\n      dateA: {\n        opened: false\n      },\n      dateB: {\n        opened: false\n      }\n    }\n\n    vm.removeAll = function() {\n      FilterService.removeAll();\n      $uibModalInstance.close(vm.filter);\n    };\n\n    vm.filterData = function() {\n      $uibModalInstance.close(vm.filter);\n    };\n\n    vm.cancel = function() {\n      $uibModalInstance.dismiss('cancel');\n    };\n\n  }\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .factory('UtilsService', UtilsService);\r\n\r\n  /** @ngInject */\r\n  function UtilsService($filter) {\r\n\r\n    var Service = {\r\n      formatDate: formatDate\r\n    };\r\n\r\n    function formatDate(date) {\r\n      return $filter('date')(date, 'dd/MM/yyyy');\r\n    }\r\n\r\n    return Service;\r\n  }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .factory('ItemDetailsService', ItemDetailsService);\r\n\r\n  /** @ngInject */\r\n  function ItemDetailsService($uibModal, GeoDataService) {\r\n\r\n    var Service = {\r\n      openModal: openModal\r\n    };\r\n\r\n\r\n    function openModal(id) {\r\n      $uibModal.open({\r\n        animation: true,\r\n        templateUrl: 'app/components/itemsDetailsModal/itemsDetailsModal.tpl.html',\r\n        controller: 'ItemDetailsModalController',\r\n        controllerAs: 'vm',\r\n        bindToController: true,\r\n        size: 'lg',\r\n        resolve: {\r\n          item: GeoDataService.getItem(id)\r\n        }\r\n      });\r\n    }\r\n\r\n    return Service;\r\n  }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .factory('GridService', GridService);\r\n\r\n  /** @ngInject */\r\n  function GridService() {\r\n\r\n    var columnDefs = [\r\n      {headerName: \"Nom\", field: \"name\"},\r\n      {headerName: \"Date\", field: \"registered\", width: 110, comparator: dateComparator},\r\n      {headerName: \"Genre\", field: \"gender\", width: 90, cellRenderer: cellRendererGender},\r\n      {headerName: \"Téléphone\", field: \"phone\"},\r\n      {headerName: \"Lat\", field: \"latitude\", width: 90},\r\n      {headerName: \"Lon\", field: \"longitude\", width: 90},\r\n      {headerName: \"Id\", field: \"id\"}\r\n    ];\r\n\r\n    var gridOptions = {\r\n      columnDefs: columnDefs,\r\n      enableSorting: true,\r\n      pinnedColumnCount: 1,\r\n      rowData: []\r\n    };\r\n\r\n    var Service = {\r\n      gridOptions: gridOptions,\r\n      dateComparator: dateComparator\r\n    };\r\n\r\n    function dateComparator(date1, date2) {\r\n      var date1Number = monthToComparableNumber(date1);\r\n      var date2Number = monthToComparableNumber(date2);\r\n\r\n      if (date1Number===null && date2Number===null) {\r\n        return 0;\r\n      }\r\n      if (date1Number===null) {\r\n        return -1;\r\n      }\r\n      if (date2Number===null) {\r\n        return 1;\r\n      }\r\n\r\n      return date1Number - date2Number;\r\n    }\r\n\r\n    function monthToComparableNumber(date) {\r\n      if (date === undefined || date === null || date.length !== 10) {\r\n          return null;\r\n      }\r\n\r\n      var yearNumber = date.substring(6,10);\r\n      var monthNumber = date.substring(3,5);\r\n      var dayNumber = date.substring(0,2);\r\n\r\n      var result = (yearNumber*10000) + (monthNumber*100) + dayNumber;\r\n      return result;\r\n    }\r\n\r\n    function cellRendererGender(params) {\r\n      if (params.value == 'female') {\r\n        return 'Femme';\r\n      } else {\r\n        return 'Homme';\r\n      }\r\n    }\r\n\r\n    return Service;\r\n  }\r\n})();\r\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .factory('GeoDataService', GeoDataService);\n\n  /** @ngInject */\n  function GeoDataService($log, $http, $timeout, $q, GridService, UtilsService, Files) {\n    var _list = [];\n    var _filteredList = [];\n    var _observer;\n\n    L.Icon.Default.imagePath = 'assets/images/leaflet';\n\n    var Service = {\n      totalItems: 0,\n      mapWIP: true,\n      list: Rx.Observable.create(function(observer) {\n        _observer = observer;\n      }).share(),\n      loadData: loadData,\n      filterData: filterData,\n      getItem: getItem\n    };\n\n    $timeout(function() {\n      _observer.onNext(_list);\n    });\n\n    function loadData() {\n      $q.all(Files.map(function (item) {\n        return $http({\n          method: 'GET',\n          url: item\n        });\n      })).then(loadDataComplete).catch(loadDataFailed);\n\n      function loadDataComplete(results) {\n        angular.forEach(results, function (result) {\n          _list = _list.concat(result.data);\n        });\n\n        \n        $timeout(function() {\n          Service.totalItems = _list.length;\n          _observer.onNext(_list);\n        }, 1000);\n      }\n\n      function loadDataFailed(error) {\n        $log.error('XHR Failed for getData.' + angular.toJson(error.data, true));\n      }\n    }\n\n    function getItem(id) {\n      return _.find(_list, function(item) { item.id = id; });\n    }\n\n    function filterData(filter) {\n\n      $timeout(function() {\n\n        // Si aucun filtre activé, on retourne la liste compléte\n        if( !filter.name.enabled && !filter.gender.enabled && !filter.position.enabled && !filter.date.enabled )\n        {\n          _observer.onNext(_list);\n          return;\n        }\n\n        _filteredList = _list.filter(function(item) {\n\n          // Filter on NAME\n          if( filter.name.enabled && \n              filter.name.value != '' && \n              item.name.indexOf(filter.name.value) == -1 )\n                return false;\n\n          // Filter on GENDER\n          if( filter.gender.enabled && \n              filter.gender.value != '' && \n              item.gender != filter.gender.value ) \n                return false;\n\n          // Filter on POSITION\n          if(filter.position.enabled) {\n            if( filter.position.startLatValue != '' && \n                item.latitude < filter.position.startLatValue ) \n                  return false;\n\n            if( filter.position.endLatValue != '' && \n                item.latitude > filter.position.endLatValue ) \n                  return false;\n\n            if( filter.position.startLngValue != '' && \n                item.longitude < filter.position.startLngValue ) \n                  return false;\n\n            if( filter.position.endLngValue != '' && \n                item.longitude > filter.position.endLngValue ) \n                  return false;\n          }\n\n          // Filter on DATE\n          if(filter.date.enabled) {\n            if( filter.date.startValue != '' && \n                GridService.dateComparator(UtilsService.formatDate(filter.date.startValue), item.registered) > 0 ) \n                  return false;\n\n            if( filter.date.endValue != '' && \n                GridService.dateComparator(UtilsService.formatDate(filter.date.endValue), item.registered) < 0 ) \n                  return false;\n          }\n          return true;\n        });\n\n        _observer.onNext(_filteredList);\n      });\n    }\n\n    return Service;\n  }\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .factory('FilterService', FilterService);\r\n\r\n  /** @ngInject */\r\n  function FilterService($uibModal, $log, $sce, GeoDataService, UtilsService) {\r\n    var _currentFilter = {\r\n      name: {\r\n        enabled: false,\r\n        value: ''\r\n      },\r\n      date: {\r\n        enabled: false,\r\n        startValue: '',\r\n        endValue: ''\r\n      },\r\n      gender: {\r\n        enabled: false,\r\n        value: ''\r\n      },\r\n      position: {\r\n        enabled: false,\r\n        startLatValue: '',\r\n        endLatValue: '',\r\n        startLngValue: '',\r\n        endLngValue: ''\r\n      }\r\n    };\r\n\r\n    var datepickerOptions = {\r\n      formatYear: 'yy',\r\n      startingDay: 1\r\n    };\r\n\r\n    var Service = {\r\n      filter: _currentFilter,\r\n      datepickerOptions: datepickerOptions,\r\n      filterDisplayText: getDisplay(),\r\n      openModal: openModal,\r\n      removeAll: removeAll,\r\n      removeAllAndRefresh: removeAllAndRefresh\r\n    };\r\n\r\n\r\n    function openModal() {\r\n      var modalInstance = $uibModal.open({\r\n        animation: true,\r\n        templateUrl: 'app/components/filterModal/erFilterModal.tpl.html',\r\n        controller: 'ErFilterModalController',\r\n        controllerAs: 'vm',\r\n        bindToController: true,\r\n        size: 'lg'\r\n      });\r\n\r\n      modalInstance.result.then(function () {\r\n        refreshData();\r\n      }, function () {\r\n        $log.info('Modal dismissed at: ' + new Date());\r\n      });\r\n    }\r\n\r\n    function removeAll() {\r\n      Service.filter.name.enabled = false;\r\n      Service.filter.date.enabled = false;\r\n      Service.filter.gender.enabled = false;\r\n      Service.filter.position.enabled = false;\r\n    }\r\n\r\n    function removeAllAndRefresh() {\r\n        removeAll();\r\n        refreshData();\r\n    }\r\n\r\n    function refreshData() {\r\n      Service.filterDisplayText = getDisplay();\r\n      GeoDataService.filterData(_currentFilter);\r\n    }\r\n\r\n    function getDisplay() {\r\n      var txt = '';\r\n\r\n      if(_currentFilter.name.enabled && _currentFilter.name.value != '') {\r\n        txt += '<span>Nom: <span class=\"val\">' + _currentFilter.name.value + '</span></span>';\r\n      }\r\n      if(_currentFilter.gender.enabled && _currentFilter.gender.value != '') {\r\n        txt += '<span>Genre: <span class=\"val\">' + (_currentFilter.gender.value == 'male' ? 'Homme' : 'Femme') + '</span></span>';\r\n      }\r\n      if(_currentFilter.date.enabled) {\r\n        if(_currentFilter.date.startValue != '') txt += '<span>Date début: <span class=\"val\">' + UtilsService.formatDate(_currentFilter.date.startValue) + '</span></span>';\r\n        if(_currentFilter.date.endValue != '') txt += '<span>Date fin: <span class=\"val\">' + UtilsService.formatDate(_currentFilter.date.endValue) + '</span></span>';\r\n      }\r\n      if(_currentFilter.position.enabled) {\r\n        if(_currentFilter.position.startLatValue != '') txt += '<span>Lat min: <span class=\"val\">' + _currentFilter.position.startLatValue + '</span></span>';\r\n        if(_currentFilter.position.endLatValue != '') txt += '<span>Lat max: <span class=\"val\">' + _currentFilter.position.endLatValue + '</span></span>';\r\n        if(_currentFilter.position.startLngValue != '') txt += '<span>Lng min: <span class=\"val\">' + _currentFilter.position.startLngValue + '</span></span>';\r\n        if(_currentFilter.position.endLngValue != '') txt += '<span>Lng max: <span class=\"val\">' + _currentFilter.position.endLngValue + '</span></span>';\r\n      }\r\n\r\n      return (txt == '' ? ' <span class=\"val\">Aucun filtre</span>' : $sce.trustAsHtml(txt));\r\n    }\r\n\r\n    return Service;\r\n  }\r\n})();\r\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/map',\n        template: '<er-main></er-main>'\n      });\n\n    $urlRouterProvider.otherwise('/map');\n  }\n\n})();\n\n/* global malarkey:false, moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .constant('Files', [\n      'assets/data/positions.json', \n      'assets/data/positions2.json', \n      'assets/data/positions3.json'\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n  }\n\n})();\n\nangular.module(\"app\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/components/filterModal/erFilterModal.tpl.html\",\"<div class=\\\"erFilterModal\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\">Critères de filtrage:</h3></div><div class=\\\"modal-body\\\"><form name=\\\"vm.mainForm\\\" class=\\\"form-inline\\\"><table class=\\\"table table-hover\\\"><tbody><tr><td><label><input type=\\\"checkbox\\\" ng-model=\\\"vm.filter.name.enabled\\\"> Nom:</label></td><td ng-class=\\\"{\\'formOff\\': !vm.filter.name.enabled}\\\"><form name=\\\"vm.nameForm\\\"><label>Contient: <input type=\\\"text\\\" ng-model=\\\"vm.filter.name.value\\\" ng-disabled=\\\"!vm.filter.name.enabled\\\" class=\\\"form-control\\\" required=\\\"\\\"></label></form></td></tr><tr><td><label><input type=\\\"checkbox\\\" ng-model=\\\"vm.filter.gender.enabled\\\"> Genre:</label></td><td ng-class=\\\"{\\'formOff\\': !vm.filter.gender.enabled}\\\"><form name=\\\"vm.genderForm\\\" class=\\\"form-inline\\\"><label class=\\\"radio-inline\\\"><input type=\\\"radio\\\" ng-model=\\\"vm.filter.gender.value\\\" ng-disabled=\\\"!vm.filter.gender.enabled\\\" name=\\\"inlineRadioOptions\\\" value=\\\"male\\\"> Homme</label> <label class=\\\"radio-inline\\\"><input type=\\\"radio\\\" ng-model=\\\"vm.filter.gender.value\\\" ng-disabled=\\\"!vm.filter.gender.enabled\\\" name=\\\"inlineRadioOptions\\\" value=\\\"female\\\"> Femme</label></form></td></tr><tr><td><label><input type=\\\"checkbox\\\" ng-model=\\\"vm.filter.date.enabled\\\"> Date:</label></td><td ng-class=\\\"{\\'formOff\\': !vm.filter.date.enabled}\\\"><form name=\\\"vm.dateForm\\\" class=\\\"form-inline\\\">Début:<div class=\\\"input-group\\\"><input type=\\\"date\\\" uib-datepicker-popup=\\\"dd/MM/yyyy\\\" ng-model=\\\"vm.filter.date.startValue\\\" is-open=\\\"vm.date.dateA.opened\\\" datepicker-options=\\\"vm.datepickerOptions\\\" date-disabled=\\\"!vm.filter.date.enabled\\\" ng-disabled=\\\"!vm.filter.date.enabled\\\" close-text=\\\"Fermer\\\" class=\\\"form-control\\\" readonly=\\\"\\\"> <span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" ng-click=\\\"vm.date.dateA.opened = true\\\" ng-disabled=\\\"!vm.filter.date.enabled\\\"><i class=\\\"glyphicon glyphicon-calendar\\\"></i></button></span></div>- Fin:<div class=\\\"input-group\\\"><input type=\\\"date\\\" uib-datepicker-popup=\\\"dd/MM/yyyy\\\" ng-model=\\\"vm.filter.date.endValue\\\" is-open=\\\"vm.date.dateB.opened\\\" datepicker-options=\\\"vm.datepickerOptions\\\" date-disabled=\\\"!vm.filter.date.enabled\\\" ng-disabled=\\\"!vm.filter.date.enabled\\\" close-text=\\\"Fermer\\\" class=\\\"form-control\\\" readonly=\\\"\\\"> <span class=\\\"input-group-btn\\\"><button type=\\\"button\\\" class=\\\"btn btn-default\\\" ng-click=\\\"vm.date.dateB.opened = true\\\" ng-disabled=\\\"!vm.filter.date.enabled\\\"><i class=\\\"glyphicon glyphicon-calendar\\\"></i></button></span></div></form></td></tr><tr><td><label><input type=\\\"checkbox\\\" ng-model=\\\"vm.filter.position.enabled\\\"> Position:</label></td><td ng-class=\\\"{\\'formOff\\': !vm.filter.position.enabled}\\\"><form name=\\\"vm.positionForm\\\"><label>Latitude min: <input type=\\\"number\\\" ng-model=\\\"vm.filter.position.startLatValue\\\" ng-disabled=\\\"!vm.filter.position.enabled\\\" class=\\\"form-control\\\" min=\\\"-90\\\" max=\\\"90\\\" step=\\\"0.001\\\" required=\\\"\\\"></label> <label>Latitude max: <input type=\\\"number\\\" ng-model=\\\"vm.filter.position.endLatValue\\\" ng-disabled=\\\"!vm.filter.position.enabled\\\" class=\\\"form-control\\\" min=\\\"-90\\\" max=\\\"90\\\" step=\\\"0.001\\\" required=\\\"\\\"></label><br><label>Longitude min: <input type=\\\"number\\\" ng-model=\\\"vm.filter.position.startLngValue\\\" ng-disabled=\\\"!vm.filter.position.enabled\\\" class=\\\"form-control\\\" min=\\\"-180\\\" max=\\\"180\\\" step=\\\"0.001\\\" required=\\\"\\\"></label> <label>Longitude max: <input type=\\\"number\\\" ng-model=\\\"vm.filter.position.endLngValue\\\" ng-disabled=\\\"!vm.filter.position.enabled\\\" class=\\\"form-control\\\" min=\\\"-180\\\" max=\\\"180\\\" step=\\\"0.001\\\" required=\\\"\\\"></label></form></td></tr></tbody></table></form></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-danger pull-left\\\" type=\\\"button\\\" ng-click=\\\"vm.removeAll()\\\" ng-disabled=\\\"vm.GeoDataService.mapWIP\\\"><span class=\\\"glyphicon glyphicon-remove\\\"></span> Supprimer</button> <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"vm.cancel()\\\">Fermer</button> <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"vm.filterData()\\\" ng-disabled=\\\"vm.GeoDataService.mapWIP\\\"><span class=\\\"glyphicon glyphicon-filter\\\"></span> Filtrer</button></div></div>\");\n$templateCache.put(\"app/components/grid/erGrid.tpl.html\",\"<div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><h3 class=\\\"panel-title text-center\\\">Grille</h3></div><div class=\\\"panel-body\\\"><div ag-grid=\\\"vm.gridOptions\\\" class=\\\"ag-fresh\\\"></div></div></div>\");\n$templateCache.put(\"app/components/itemDetailsModal/itemDetailsModal.tpl.html\",\"<div class=\\\"itemDetailsModal\\\"><div class=\\\"modal-header\\\"><h3 class=\\\"modal-title\\\">Détails:</h3></div><div class=\\\"modal-body\\\"><form name=\\\"vm.mainForm\\\" class=\\\"form-inline\\\"><table class=\\\"table table-hover\\\"><tbody><tr><td></td><td></td></tr></tbody></table></form></div><div class=\\\"modal-footer\\\"><button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"vm.close()\\\">Fermer</button></div></div>\");\n$templateCache.put(\"app/components/main/erMain.tpl.html\",\"<nav class=\\\"navbar navbar-inverse\\\"><div class=\\\"container\\\"><p class=\\\"navbar-text filter-bloc\\\"><strong>Filtres:</strong> <span ng-bind-html=\\\"vm.FilterService.filterDisplayText\\\" class=\\\"filter-display\\\"></span> <button ng-click=\\\"vm.FilterService.openModal()\\\" ng-disabled=\\\"vm.GeoDataService.mapWIP\\\" class=\\\"btn btn-sm btn-primary\\\"><span class=\\\"glyphicon glyphicon-pencil\\\"></span> Modifier</button> <button ng-click=\\\"vm.FilterService.removeAllAndRefresh()\\\" ng-disabled=\\\"vm.GeoDataService.mapWIP\\\" class=\\\"btn btn-sm btn-danger\\\"><span class=\\\"glyphicon glyphicon-remove\\\"></span> Supprimer</button> <span ng-show=\\\"vm.GeoDataService.mapWIP\\\" class=\\\"glyphicon glyphicon-time\\\"></span></p><p class=\\\"navbar-text navbar-right\\\"><strong>Données affichées:</strong> {{ vm.totalDisplayItems + \\' / \\' + vm.GeoDataService.totalItems }}<button class=\\\"btn btn-sm btn-danger\\\" style=\\\"opacity: 0;\\\">X</button></p></div></nav><div class=\\\"container-fluid\\\"><div ng-if=\\\"vm.GeoDataService.totalItems == 0\\\" class=\\\"text-center\\\"><span class=\\\"badge\\\">Chargement des fichiers..</span></div><div ng-class=\\\"{\\'hideMe\\': vm.GeoDataService.totalItems == 0}\\\"><div class=\\\"col-md-6 col-sm-12\\\"><er-grid></er-grid></div><div class=\\\"col-md-6 col-sm-12\\\"><er-map></er-map></div></div></div>\");\n$templateCache.put(\"app/components/map/erMap.tpl.html\",\"<div class=\\\"panel panel-default\\\"><div class=\\\"panel-heading\\\"><h3 class=\\\"panel-title text-center\\\">Carte</h3></div><div class=\\\"panel-body\\\"><div id=\\\"progress\\\"><div id=\\\"progress-bar\\\"></div></div><div id=\\\"map\\\"></div></div></div>\");}]);"],"sourceRoot":"/source/"}